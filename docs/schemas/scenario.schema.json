{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Scenario Data",
    "type": "object",
    "required": [
        "scenarioId",
        "scenes"
    ],
    "properties": {
        "scenarioId": {
            "type": "string",
            "description": "Unique identifier for the scenario"
        },
        "scenes": {
            "type": "object",
            "additionalProperties": {
                "type": "array",
                "items": {
                    "$ref": "#/definitions/ScenarioCommand"
                }
            },
            "description": "Map of scene IDs to arrays of commands"
        }
    },
    "definitions": {
        "ScenarioCommand": {
            "type": "object",
            "discriminator": {
                "propertyName": "type"
            },
            "required": [
                "type"
            ],
            "properties": {
                "type": {
                    "type": "string",
                    "enum": [
                        "text",
                        "show_card",
                        "hide_card",
                        "bg",
                        "choice",
                        "jump",
                        "battle"
                    ]
                }
            },
            "oneOf": [
                {
                    "$ref": "#/definitions/CmdText"
                },
                {
                    "$ref": "#/definitions/CmdShowCard"
                },
                {
                    "$ref": "#/definitions/CmdHideCard"
                },
                {
                    "$ref": "#/definitions/CmdBg"
                },
                {
                    "$ref": "#/definitions/CmdChoice"
                },
                {
                    "$ref": "#/definitions/CmdJump"
                },
                {
                    "$ref": "#/definitions/CmdBattle"
                }
            ]
        },
        "CmdText": {
            "type": "object",
            "properties": {
                "type": {
                    "const": "text"
                },
                "speaker": {
                    "type": "string"
                },
                "content": {
                    "type": "string"
                }
            },
            "required": [
                "type",
                "speaker",
                "content"
            ]
        },
        "CmdShowCard": {
            "type": "object",
            "properties": {
                "type": {
                    "const": "show_card"
                },
                "cardId": {
                    "type": "string"
                },
                "position": {
                    "type": "string",
                    "enum": [
                        "left",
                        "center",
                        "right"
                    ]
                },
                "anim": {
                    "type": "string"
                }
            },
            "required": [
                "type",
                "cardId",
                "position"
            ]
        },
        "CmdHideCard": {
            "type": "object",
            "properties": {
                "type": {
                    "const": "hide_card"
                },
                "cardId": {
                    "type": "string"
                }
            },
            "required": [
                "type",
                "cardId"
            ]
        },
        "CmdBg": {
            "type": "object",
            "properties": {
                "type": {
                    "const": "bg"
                },
                "value": {
                    "type": "string"
                }
            },
            "required": [
                "type",
                "value"
            ]
        },
        "CmdChoice": {
            "type": "object",
            "properties": {
                "type": {
                    "const": "choice"
                },
                "options": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "properties": {
                            "label": {
                                "type": "string"
                            },
                            "nextScene": {
                                "type": "string"
                            },
                            "action": {
                                "type": "string"
                            }
                        },
                        "required": [
                            "label",
                            "nextScene"
                        ]
                    }
                }
            },
            "required": [
                "type",
                "options"
            ]
        },
        "CmdJump": {
            "type": "object",
            "properties": {
                "type": {
                    "const": "jump"
                },
                "nextScene": {
                    "type": "string"
                }
            },
            "required": [
                "type",
                "nextScene"
            ]
        },
        "CmdBattle": {
            "type": "object",
            "properties": {
                "type": {
                    "const": "battle"
                },
                "enemyId": {
                    "type": "string"
                },
                "nextScene": {
                    "type": "string"
                }
            },
            "required": [
                "type",
                "enemyId",
                "nextScene"
            ]
        }
    }
}